let handler = m => m;

handler.all = async function (m) {
  let chat = global.db.data.chats[m.chat];
  let responses, lastResponseKey;

  // وظيفة لتوليد رد عشوائي والتأكد من عدم التكرار
  function getRandomResponse(responses, lastResponseKey) {
    let randomIndex, newResponse;

    do {
      randomIndex = Math.floor(Math.random() * responses.length);
      newResponse = responses[randomIndex];
    } while (newResponse === chat[lastResponseKey]);

    chat[lastResponseKey] = newResponse;
    return newResponse;
  }

  if (/^بوت بحبك|حبك|بحبك|حبق|بوت عاوزه اتجوزك|بحبك|بموت فيك|نتجوز|بوت هنتجوز امتي|بوت انت ليا|بوت بموت فيك$/i.test(m.text)) {
    responses = [
      'شكرا يا قمر 😘',
      'هفكر في الموضوع بصراحة 🤔',
      'وأنا بحبك والله 🥰',
      'استحيت والله 😳',
      'خلاص ما تكسفنيش كده 😅',
      'اسكت بقى عشان ما اضربكش 😜',
      'طيب و بعدين؟ 🤷‍♂️',
      '_*امممم 😳*_',
      '*_أنا أكتر 🤭🌸_*',
      '*_بس بقي بتكسف 🤭🌸_*',
      'ده الكلام اللي بعوزه أسمعه 🤭',
      'أنت عارف إنك بتحرجني؟ 😅',
      'مين فينا هيعمل العشا؟ 🍽️',
      'أنا مش مستعد لده 😅',
      'إيه ده المفاجأة دي؟ 😮',
      'حقيقي؟ ولا بتهزر؟ 🤔',
      'طب نتجوز فين؟ 💍'
    ];
    lastResponseKey = 'lastLoveResponse';
  } else if (/^السلام عليكم|سلام عليكم ورحمه الله وبركاته|سلام عليكم|السلام عليكم ورحمه الله وبركاته$/i.test(m.text)) {
    responses = [
      'وعليكم السلام يا نجم 🌟',
      'وعليكم السلام ورحمة الله وبركاته ✨',
      'أهلاً أهلاً، نورت ✨',
      'وعليكم السلام، إيه الأخبار؟ 🤔',
      'وعليكم السلام يا حبيبي 💖',
      'إزيك؟ 😄',
      'سلامات يا باشا 🙌'
    ];
    lastResponseKey = 'lastGreetingResponse';
  } else if (/^ بوت عامل ايه|عامله ايه|عاملين ايه|الدنيا عامله ايه|عاملين ايه يشبب$/i.test(m.text)) {
    responses = [
      'كل حاجة تمام الحمد لله 🙌',
      'مش عارف، إنت إيه رأيك؟ 🤔',
      'الحمد لله كله زي الفل 🌸',
      'لو إنت كويس أنا كويس 😄',
      'زحمة يا دنيا زحمة 🚗🚶‍♂️',
      'كويس وإنت؟ 🤷‍♂️',
      'الدنيا مش بطالة 😅'
    ];
    lastResponseKey = 'lastStatusResponse';
  } else if (/^كل خرا|وسخ|عرص|خول|متناك|كسمك|علق|يا شرموط|ابن وسخة|شرموط|كلب$/i.test(m.text)) {
    responses = [
      'عيب كده 🙄',
      'اتأدب بقى 😡',
      'يا وسخ 🤢',
      'الله يهديك 🙏',
      'عيب يا واد 😒',
      'إيه الكلام ده؟ 🤨',
      'مش كده يا محترم 😑',
      'بلاش قلة أدب 🚫'
    ];
    lastResponseKey = 'lastInsultResponse';
  } else if (/^تم تعريب هذا الامر|تم الانتهاء|تمت اضافه|تمت اضافة|تم التعريب|هذا الامر انتهي$/i.test(m.text)) {
    responses = [
      'عاشت إيدك ✨💜',
      'تسلم إيدك ✨💜',
      'عاش يا باشا ✨💜',
      'عاش تربو ✨💜',
      'تمام كده ✨💜',
      'شكراً يا بطل 🦸‍♂️',
      'جميل جداً! 👏',
      'تمام التمام 👍',
      'برافو عليك 👌'
    ];
    lastResponseKey = 'lastCompletionResponse';
  } else if (/^لول|هههه|ههههه|هههههه|ههههههه|هههههههه|😂😂😂$/i.test(m.text)) {
    responses = [
      'دوم دي ضحكة حلوة 😂',
      'ضحكني معاك 🤣',
      'دوم يا رب 😁',
      'هههه 😆',
      '😂😂😂',
      'إيه اللي بيضحك؟ 🤨',
      'اضحك معاك؟ 🤪',
      'ضحكتك تجيب السعادة 😊',
      'إنت جميل لما تضحك 🥰',
      'دوم الضحكة الحلوة دي 🤩'
    ];
    lastResponseKey = 'lastLaughResponse';
  } else if (/^تربو|تربو عمك|يا تربو$/i.test(m.text)) {
    responses = [
      'قلب تربو من جوا✨🥺♥',
      'تربو عمك✨🤺',
      'نعم يا باشا؟ 🤔',
      'مين طلبني؟ 👀',
      'أنا هنا يا نجم ✨',
      'تربو في الخدمة 🛠️',
      'أؤمرني يا حبي 💖'
    ];
    lastResponseKey = 'lastTurboResponse';
  } else if (/^بوت|يا بوت|البوت|ولا|بوووت|بووووت|بوووووت|بووووووووت$/i.test(m.text)) {
    responses = [
      '*نعم* 🌚',
      '*عاوز إيه* 🤔',
      '*قلب البوت* ✨♥',
      '*آي يخويا*🌚',
      '*موجود ينجم* 🌚',
      '*لو بتجرب ف أنا شغال* 🌚',
      '*تحت أمرك يا باشا* 🌚',
      '*خير* 🙂',
      '*إيه بدك 👀♥️✨*',
      '*أأمر يا عيوني 🤭💮✨*',
      '*أهلاً وسهلاً! أنا بوت واتساب وأدعى تربو، عايز تعرف الأوامر؟ كُل اللي عليك هو تبعت أمر *.اوامر*.\nأنا هنا عشان أساعدك في إدارة مجموعتك، وكمان ممكن تستخدمني بشكل شخصي. أقدر أعمل لك ملصقات، أحول الصور لملصقات، وأحمي مجموعتك من المزعجين والكثير من المزايا التانية. لو محتاج تعرف أكتر عن البوت، كلم سيدي!*',
      '*أؤمرني يا حبي*🌺🧸',
      '*إيه فيه إيه؟*🙂'
    ];
    lastResponseKey = 'lastBotResponse';
  } else if (/^صباح النور|صباح النعناع الاخصر|صباح الفل|صباح|باحالخير|باح الخير|صباح الخير$/i.test(m.text)) {
    responses = [
      'صباح الفل ✨💜',
      'صباح النور ✨💜',
      'صباح الكاريزما ✨💜',
      'إنت صحيت وأنا رايح أنام 🐦👋🏻',
      'روح نام تاني بقى 🙃',
      'صباح الورد 🌹',
      'صباح العسل 🍯',
      'صباح الورد والياسمين 🌸',
      'أحلى صباح لأحلى ناس ☀️'
    ];
    lastResponseKey = 'lastMorningResponse';
  } else if (/^شكرا|تسلم|تسلمي$/i.test(m.text)) {
    responses = [
      'العفو✨🥺♥',
      'ولا يهمك مفيش حاجة✨💫',
      'الشكر لله ✨💜',
      'العفو يا باشا ✨💜',
      'إحنا هنا عشانك ✨',
      'على راسي 🧢',
      'أنت تؤمر 🛠️',
      'ربنا يخليك 🌟'
    ];
    lastResponseKey = 'lastThanksResponse';
  } else if (/^🧡|💚|💞|💖|💜|💛|🤍$/i.test(m.text)) {
    responses = [
      'شكراً✨♥',
      'تسلم✨♥',
      '✨♥',
      'حبيبي✨💜',
      '✨💜',
      'إحنا كده مع بعض 🌸',
      'ألوان الحب 🌈',
      'أنت الحب كله 💖',
      'قلبك كبير 💝'
    ];
    lastResponseKey = 'lastHeartResponse';
} else if (/^كل ده نور|الجروب نور كده ليه|ايه النور ده|منورين الجدد|منورين|منور$/i.test(m.text)) {
  responses = [
    'نوري أنا✨♥️',
    'الجروب نور فعلاً✨♥️',
    '✨♥️',
    'الجروب منور✨💜',
    '✨💜',
    'نورتونا يا أحلى ناس🌟',
    'النور نوركم💡',
    'منورين الدنيا كلها🌍',
    'إيه الجمال ده؟🌟'
  ];
  lastResponseKey = 'lastLightResponse';
} else if (/^اسكت|هتسكت امتي|يا ابني اسكت$/i.test(m.text)) {
  responses = [
    'ملكش دعوه 😜',
    'لع وانت مالك 😂',
    'مش بمزاجك 😎',
    'لا مين انت ال هتسكتني 😏',
    'اسكت انت 😅',
    'قول حاجة حلوة بدل ما تقول تسكت 🥳',
    'بلاش نكد 🙄'
  ];
  lastResponseKey = 'lastSilenceResponse';
}

if (responses) {
  let response = getRandomResponse(responses, lastResponseKey);
  conn.reply(m.chat, response, m);
}

return true;
};

export default handler;